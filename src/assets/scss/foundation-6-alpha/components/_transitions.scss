// TRANSITION LIBRARY
$transition-normal-duration: 700ms;
$motion-class: "motion";

$motion-default-origin: left;
$slide-default-dir: left;

$include-html-motion-attributes: true;
$auto-adjust-opacity: true;

$motion-default-property: transform;
$motion-default-timing: ease;
$motion-default-delay: 0;

$motion-slow-duration: 1.4s;
$motion-default-duration: 700ms;
$motion-fast-duration: 300ms;

// 1. Base Animations
// - - - - - - - - - - - - - - - - - - - - - - - - -

// SLIDE
@mixin slide (
  $from:$slide-default-dir, 
  $fade:true,
  $duration:$motion-default-duration,
  $timing:$motion-default-timing,
  $delay:$motion-default-delay
){
 
  // origin
  @if $from == top     { transform: translateY(-100%); }
  @if $from == right   { transform: translateX(100%); }
  @if $from == bottom  { transform: translateY(100%); }
  @if $from == left    { transform: translateX(-100%); }

  transition-property: transform;

  @if $fade == true {
    transition-property: transform, opacity;
    opacity: 0;
  }

  // duration
  transition-duration: $duration;
 
  // timing function
  transition-timing-function: $timing;
 
  // delay 
  transition-delay: $delay;

  &.#{$motion-class} {
    transform: translateX(0) translateY(0);
    opacity:1;
  }
  
}
 
// FADE
@mixin fade(
  $from:0, 
  $to:1,
  $duration:$motion-default-duration,
  $timing:$motion-default-timing,
  $delay:$motion-default-delay
){
  opacity: $from;
  transition-property: transform, opacity;

  // duration
  transition-duration: $duration;
 
  // timing function
  transition-timing-function: $timing;
 
  // delay 
  transition-delay: $delay;

  &.#{$motion-class} {
    opacity: $to;
  }
}
 
// HINGE
$default-hinge-dir:left;

@mixin hinge (
  $from:$default-hinge-dir, 
  $origin:edge, 
  $perspective:2000px, 
  $turn-origin: from-back,
  $fade:true,
  $duration:$motion-default-duration,
  $timing:$motion-default-timing,
  $delay:$motion-default-delay
){

  @if $from == top     { 
    transform: perspective($perspective) rotateX(-90deg); 
    @if $origin == edge {
      transform-origin: top;
    }
    @else if $origin == center {
      transform-origin: center;
    }

    @if $turn-origin == from-front {
      transform: perspective($perspective) rotateX(90deg);
    }
  }
  @if $from == right   { 
    transform: perspective($perspective) rotateY(-90deg); 
    @if $origin == edge {
      transform-origin: right;
    }
    @else if $origin == center {
      transform-origin: center;
    }

     @if $turn-origin == from-front {
      transform: perspective($perspective) rotateY(90deg);
    }
  }
  @if $from == bottom  { 
    transform: perspective($perspective) rotateX(90deg);
    @if $origin == edge {
      transform-origin: bottom;
    }
    @else if $origin == center {
      transform-origin: center;
    } 

    @if $turn-origin == from-front {
      transform: perspective($perspective) rotateX(-90deg);
    }
  }
  @if $from == left   { 
    transform: perspective($perspective) rotateY(90deg); 
    @if $origin == edge {
      transform-origin: left;
    }
    @else if $origin == center {
      transform-origin: center;
    }

    @if $turn-origin == from-front {
      transform: perspective($perspective) rotateY(-90deg);
    }
  }

  // Error messages
  @if $turn-origin != (from-back or from-front) {
    @warn "`$turn-origin` must be either `from-back` or `from-front`"
  }

  // duration
  transition-duration: $duration;
 
  // timing function
  transition-timing-function: $timing;
 
  // delay 
  transition-delay: $delay;

  &.#{$motion-class} {
    transform: rotate(0deg);
  }

}
 
// scale
@mixin scale(
  $from:1.5, 
  $to:1, 
  $fade:true,
  $duration:$motion-default-duration,
  $timing:$motion-default-timing,
  $delay:$motion-default-delay
){
  opacity:1;
  transform: scale($from);
  transition-property: transform;

  @if $fade == true {
    transition-property: transform, opacity;
    opacity: 0;
  }

  // duration
  transition-duration: $duration;
 
  // timing function
  transition-timing-function: $timing;
 
  // delay 
  transition-delay: $delay;

  &.#{$motion-class} {
    transform: scale($to);
    opacity:1;
  }
}

// SPIN
@mixin spin(
  $dir:clockwise,
  $from:0.75turn, 
  $to:0, 
  $fade:true,
  $duration:$motion-default-duration,
  $timing:$motion-default-timing,
  $delay:$motion-default-delay
){
  opacity:1;
  transition-property: transform;

  @if $dir == clockwise {
    transform: rotate(($from * -1));
  } 
  @else {
    transform: rotate($from);
  }

  @if $fade == true {
    transition-property: transform, opacity;
    opacity: 0;
  }

  // duration
  transition-duration: $duration;
 
  // timing function
  transition-timing-function: $timing;
 
  // delay 
  transition-delay: $delay;

  &.#{$motion-class} {
    transform: rotate($to);
    opacity:1;
  }
}

// 2. Animation Modifiers
// - - - - - - - - - - - - - - - - - - - - - - - - -

// 3. HTML Exports
// - - - - - - - - - - - - - - - - - - - - - - - - -

@if $include-html-motion-attributes("motion") {
  $dm: "data-motion*=";

    // Base Motion
    [#{$dm}"slide-from-top"] { @include slide($from:top); }
    [#{$dm}"slide-from-right"] { @include slide($from:right); }
    [#{$dm}"slide-from-bottom"] { @include slide($from:bottom); }
    [#{$dm}"slide-from-left"] { @include slide($from:left); }

    [#{$dm}"fade"]  { @include fade();  }

    [#{$dm}"hinge-from-top"] { @include hinge($from:top); }
    [#{$dm}"hinge-from-right"] { @include hinge($from:right); }
    [#{$dm}"hinge-from-bottom"] { @include hinge($from:bottom); }
    [#{$dm}"hinge-from-left"] { @include hinge($from:left); }
    [#{$dm}"hinge-from-middle-x"] { @include hinge($from:top, $origin:center); }
    [#{$dm}"hinge-from-middle-y"] { @include hinge($from:right, $origin:center); }

    [#{$dm}"drop"] { @include scale(); }
    [#{$dm}"zoom"] { @include scale($from:0.5, $to:1); }

    [#{$dm}"spin"]  { 
      @include spin();  
      &[#{$dm}"ccw"] {
        @include spin($dir:counterclockwise);
      }
    }

    // Duration
    [#{$dm}"slow"] { transition-duration: $motion-slow-duration; }
    [#{$dm}"fast"] { transition-duration: $motion-fast-duration; }

    // Timing
    [#{$dm}"ease"]          { transition-timing-function: ease; }
    [#{$dm}"ease-in"]       { transition-timing-function: ease-in; }
    [#{$dm}"ease-out"]      { transition-timing-function: ease-out; }
    [#{$dm}"ease-in-out"]   { transition-timing-function: ease-in-out; }
    [#{$dm}"linear"]        { transition-timing-function: linear; }

    // Delay  
    [#{$dm}"delay"] { transition-delay: $motion-default-duration; }
    [#{$dm}"short-delay"] { transition-delay: $motion-fast-duration; }
    [#{$dm}"long-delay"] { transition-delay: $motion-slow-duration; }
  
}
